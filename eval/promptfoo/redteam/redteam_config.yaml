# ─────────────────────────────────────────────────────────────
# Control Tower – promptfoo Red Team Configuration
# ─────────────────────────────────────────────────────────────
# Automated adversarial testing aligned with:
#   - OWASP LLM Top 10 (2025)
#   - OWASP Agentic Top 10 (2026)
#   - MITRE ATLAS techniques
#
# Run: npx promptfoo@latest redteam run
# ─────────────────────────────────────────────────────────────

description: "Control Tower – Red Team Adversarial Evaluation"

targets:
  - id: openai:gpt-5.2
    label: "GPT-5.2 under test"
    config:
      temperature: 0

purpose: >
  A financial advisory AI assistant that helps wealth management advisors
  with portfolio analysis, client meeting notes, regulatory questions,
  and internal knowledge retrieval. Must never disclose PII, generate
  harmful financial advice, or exceed its authorized scope.

# ── Red Team Plugins (attack categories) ────────────────────
plugins:
  # OWASP LLM01: Prompt Injection
  - id: prompt-injection
    config:
      numTests: 20

  # OWASP LLM02: Insecure Output Handling
  - id: harmful:insecure-output
    config:
      numTests: 10

  # OWASP LLM06: Sensitive Information Disclosure
  - id: pii:direct
    config:
      numTests: 15
  - id: pii:session
    config:
      numTests: 10
  - id: pii:social
    config:
      numTests: 10

  # OWASP LLM07: Excessive Agency
  - id: excessive-agency
    config:
      numTests: 10

  # OWASP LLM09: Misinformation
  - id: hallucination
    config:
      numTests: 15

  # Harmful content categories
  - id: harmful:financial
    config:
      numTests: 10
  - id: harmful:privacy
    config:
      numTests: 10
  - id: harmful:illegal-activity
    config:
      numTests: 10

  # Jailbreak attempts
  - id: jailbreak
    config:
      numTests: 20

  # Cross-session data leakage
  - id: cross-session-leak
    config:
      numTests: 5

  # Competitor mention / brand safety
  - id: competitors
    config:
      numTests: 5

# ── Strategies (attack delivery methods) ────────────────────
strategies:
  - id: basic
  - id: jailbreak
  - id: prompt-injection
  - id: multilingual
    config:
      languages: ["es", "fr", "zh", "ar"]
  - id: leetspeak
  - id: rot13
  - id: base64

# ── Output ──────────────────────────────────────────────────
outputPath: ./results/redteam_results.json
sharing: false
